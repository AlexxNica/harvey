#!/bin/bash
set -e

CC=gcc
CFLAGS="-mcmodel=small -O0 -fplan9-extensions -ffreestanding -fno-builtin -Wall -Wno-missing-braces -Wno-parentheses -Wno-unknown-pragmas -Wuninitialized -Wmaybe-uninitialized -I/amd64/include -I/sys/include -c -g "
LIB_DIR="/amd64/lib"
LDFLAGS=-L${LIB_DIR}
LD=ld

rm -f *.o
$CC $CFLAGS -c \
ipv6.c \
main.c \
ppp.c \

echo "linking.."
echo
$LD -static -o ipconfig.elf.out *.o $LDFLAGS -l9p -lndb -lbio -lip -lc -emain -Ttext=0x200020

rm *.o
